services:
  - name: postgres:12.8-alpine
    alias: testdb

variables:
  POSTGRES_DB: nlx_management_test
  POSTGRES_USER: postgres
  POSTGRES_PASSWORD: ""
  POSTGRES_HOST_AUTH_METHOD: trust

Create test databases:
  stage: Setup
  image: postgres:12.8-alpine
  script:
    - createdb -U postgres -h testdb nlx_directory_registration_test
    - createdb -U postgres -h testdb nlx_directory_inspection_test
  rules:
    - if: '$CI_COMMIT_BRANCH' # do not run for tags
  tags:
    - docker
    - linux