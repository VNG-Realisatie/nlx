// Copyright Â© VNG Realisatie 2022
// Licensed under the EUPL

syntax = "proto3";

package nlx.management.external;

option go_package = "go.nlx.io/nlx/management-api/api/external";

import "management.proto";
import "google/protobuf/empty.proto";

service AccessRequestService {
  rpc RequestAccess (RequestAccessRequest) returns (RequestAccessResponse);
  rpc GetAccessRequestState (GetAccessRequestStateRequest) returns (GetAccessRequestStateResponse);
  rpc GetAccessProof (GetAccessProofRequest) returns (AccessProof);
}

service DelegationService {
  rpc RequestClaim (RequestClaimRequest) returns (RequestClaimResponse);
  rpc ListOrders (google.protobuf.Empty) returns (ListOrdersResponse);
}

message RequestAccessRequest {
  string service_name = 1;
  string public_key_pem = 2;
}

message GetAccessRequestStateRequest {
  string service_name = 1;
  string public_key_fingerprint = 2;
}

message GetAccessRequestStateResponse {
  nlx.management.AccessRequestState state = 1;
}

message GetAccessProofRequest {
  string service_name = 1;
  string public_key_fingerprint = 2;
}

message RequestAccessResponse {
  uint64 reference_id = 1;
  nlx.management.AccessRequestState access_request_state = 2;
}

message RequestClaimRequest {
  string order_reference = 1;
  string service_organization_serial_number = 2;
  string service_name = 3;
}

message RequestClaimResponse {
  string claim = 1;
}

message ListOrdersRequest {
}

message ListOrdersResponse {
  repeated nlx.management.IncomingOrder orders = 1;
}
