apiVersion: skaffold/v1beta5
kind: Config
build:
  artifacts:
  - image: nlxio/auth-service
    docker:
      dockerfile: auth-service/Dockerfile
  - image: nlxio/ca-certportal
    docker:
      dockerfile: ca-certportal/Dockerfile
      buildArgs:
        GIT_COMMIT_HASH: "{{.GIT_COMMIT_HASH}}"
        GIT_TAG_NAME: "{{.GIT_TAG_NAME}}"
  - image: nlxio/ca-cfssl-unsafe
    context: ca-cfssl-unsafe
  - image: nlxio/config-api
    docker:
      dockerfile: config-api/Dockerfile
      buildArgs:
        GIT_COMMIT_HASH: "{{.GIT_COMMIT_HASH}}"
        GIT_TAG_NAME: "{{.GIT_TAG_NAME}}"
  - image: nlxio/docs
    context: docs
    docker:
      buildArgs:
        GIT_COMMIT_HASH: "{{.GIT_COMMIT_HASH}}"
        GIT_TAG_NAME: "{{.GIT_TAG_NAME}}"
  - image: nlxio/directory-db
    docker:
      dockerfile: directory-db/Dockerfile
  - image: nlxio/directory-inspection-api
    docker:
      dockerfile: directory-inspection-api/Dockerfile
      buildArgs:
        GIT_COMMIT_HASH: "{{.GIT_COMMIT_HASH}}"
        GIT_TAG_NAME: "{{.GIT_TAG_NAME}}"
  - image: nlxio/directory-registration-api
    docker:
      dockerfile: directory-registration-api/Dockerfile
      buildArgs:
        GIT_COMMIT_HASH: "{{.GIT_COMMIT_HASH}}"
        GIT_TAG_NAME: "{{.GIT_TAG_NAME}}"
  - image: nlxio/directory-monitor
    docker:
      dockerfile: directory-monitor/Dockerfile
      buildArgs:
        GIT_COMMIT_HASH: "{{.GIT_COMMIT_HASH}}"
        GIT_TAG_NAME: "{{.GIT_TAG_NAME}}"
  - image: nlxio/directory-ui
    docker:
      dockerfile: directory-ui/Dockerfile
      buildArgs:
        GIT_COMMIT_HASH: "{{.GIT_COMMIT_HASH}}"
        GIT_TAG_NAME: "{{.GIT_TAG_NAME}}"
  - image: nlxio/insight-api
    docker:
      dockerfile: insight-api/Dockerfile
      buildArgs:
        GIT_COMMIT_HASH: "{{.GIT_COMMIT_HASH}}"
        GIT_TAG_NAME: "{{.GIT_TAG_NAME}}"
  - image: nlxio/insight-ui
    docker:
      dockerfile: insight-ui/Dockerfile
      buildArgs:
        GIT_COMMIT_HASH: "{{.GIT_COMMIT_HASH}}"
        GIT_TAG_NAME: "{{.GIT_TAG_NAME}}"
  - image: nlxio/inway
    docker:
      dockerfile: inway/Dockerfile
      buildArgs:
        GIT_COMMIT_HASH: "{{.GIT_COMMIT_HASH}}"
        GIT_TAG_NAME: "{{.GIT_TAG_NAME}}"
  - image: nlxio/irma
    docker:
      dockerfile: irma/Dockerfile
  - image: nlxio/management-api
    docker:
      dockerfile: management-api/Dockerfile
      buildArgs:
        GIT_COMMIT_HASH: "{{.GIT_COMMIT_HASH}}"
        GIT_TAG_NAME: "{{.GIT_TAG_NAME}}"
  - image: nlxio/management-ui
    docker:
      dockerfile: management-ui/Dockerfile
      buildArgs:
        GIT_COMMIT_HASH: "{{.GIT_COMMIT_HASH}}"
        GIT_TAG_NAME: "{{.GIT_TAG_NAME}}"
  - image: nlxio/nlxctl
    docker:
      dockerfile: nlxctl/Dockerfile
      buildArgs:
        GIT_COMMIT_HASH: "{{.GIT_COMMIT_HASH}}"
        GIT_TAG_NAME: "{{.GIT_TAG_NAME}}"
  - image: nlxio/outway
    docker:
      dockerfile: outway/Dockerfile
      buildArgs:
        GIT_COMMIT_HASH: "{{.GIT_COMMIT_HASH}}"
        GIT_TAG_NAME: "{{.GIT_TAG_NAME}}"
  - image: nlxio/review-page
    context: review-page
  - image: nlxio/txlog-db
    docker:
      dockerfile: txlog-db/Dockerfile
profiles:
- name: minikube
  build:
    tagPolicy:
      sha256: {}
    local:
      push: false
  deploy:
    helm:
      releases:
      - name: nlx-dev-directory
        chartPath: helm/nlx-directory
        valuesFiles:
        - helm/nlx-directory/values-dev.yaml
        values:
          caCertportalImage: nlxio/ca-certportal
          caCfsslUnsafeImage: nlxio/ca-cfssl-unsafe
          directoryDBImage: nlxio/directory-db
          directoryInspectionImage: nlxio/directory-inspection-api
          directoryMonitorImage: nlxio/directory-monitor
          directoryRegistrationImage: nlxio/directory-registration-api
          directoryUIImage: nlxio/directory-ui
          docsImage: nlxio/docs
          insightUIImage: nlxio/insight-ui
          reviewPageImage: nlxio/review-page
        namespace: nlx-dev-directory
      - name: nlx-dev-brp
        chartPath: helm/nlx-organization
        valuesFiles:
        - helm/nlx-organization/values-dev-brp.yaml
        values:
          authServiceImage: nlxio/auth-service
          caCfsslUnsafeImage: nlxio/ca-cfssl-unsafe
          configAPIImage: nlxio/config-api
          insightAPIImage: nlxio/insight-api
          inwayImage: nlxio/inway
          managementAPIImage: nlxio/management-api
          managementUIImage: nlxio/management-ui
          nlxctlImage: nlxio/nlxctl
          txlogDBImage: nlxio/txlog-db
        namespace: nlx-dev-brp
      - name: nlx-dev-rdw
        chartPath: helm/nlx-organization
        valuesFiles:
        - helm/nlx-organization/values-dev-rdw.yaml
        values:
          authServiceImage: nlxio/auth-service
          caCfsslUnsafeImage: nlxio/ca-cfssl-unsafe
          configAPIImage: nlxio/config-api
          insightAPIImage: nlxio/insight-api
          inwayImage: nlxio/inway
          managementAPIImage: nlxio/management-api
          managementUIImage: nlxio/management-ui
          nlxctlImage: nlxio/nlxctl
          txlogDBImage: nlxio/txlog-db
        namespace: nlx-dev-rdw
      - name: nlx-dev-haarlem
        chartPath: helm/nlx-organization
        valuesFiles:
        - helm/nlx-organization/values-dev-haarlem.yaml
        values:
          authServiceImage: nlxio/auth-service
          caCfsslUnsafeImage: nlxio/ca-cfssl-unsafe
          configAPIImage: nlxio/config-api
          insightAPIImage: nlxio/insight-api
          inwayImage: nlxio/inway
          outwayImage: nlxio/outway
          managementAPIImage: nlxio/management-api
          managementUIImage: nlxio/management-ui
          nlxctlImage: nlxio/nlxctl
          txlogDBImage: nlxio/txlog-db
        namespace: nlx-dev-haarlem
- name: acc
  build:
    tagPolicy:
      gitCommit: {}
    local:
      push: true
  deploy:
    helm:
      releases:
      - name: nlx-acc-directory
        chartPath: helm/nlx-directory
        valuesFiles:
        - helm/nlx-directory/values-acc.yaml
        values:
          caCertportalImage: nlxio/ca-certportal
          caCfsslUnsafeImage: nlxio/ca-cfssl-unsafe
          directoryDBImage: nlxio/directory-db
          directoryInspectionImage: nlxio/directory-inspection-api
          directoryMonitorImage: nlxio/directory-monitor
          directoryRegistrationImage: nlxio/directory-registration-api
          directoryUIImage: nlxio/directory-ui
          docsImage: nlxio/docs
          insightUIImage: nlxio/insight-ui
        namespace: nlx-acc-directory
      - name: nlx-acc-brp
        chartPath: helm/nlx-organization
        valuesFiles:
        - helm/nlx-organization/values-acc-brp.yaml
        values:
          authServiceImage: nlxio/auth-service
          caCfsslUnsafeImage: nlxio/ca-cfssl-unsafe
          configAPIImage: nlxio/config-api
          insightAPIImage: nlxio/insight-api
          inwayImage: nlxio/inway
          managementAPIImage: nlxio/management-api
          managementUIImage: nlxio/management-ui
          nlxctlImage: nlxio/nlxctl
          txlogDBImage: nlxio/txlog-db
        namespace: nlx-acc-brp
      - name: nlx-acc-rdw
        chartPath: helm/nlx-organization
        valuesFiles:
        - helm/nlx-organization/values-acc-rdw.yaml
        setValueTemplates:
         management.basicAuth: "{{.MANAGEMENT_BASIC_AUTH}}"
        values:
          authServiceImage: nlxio/auth-service
          caCfsslUnsafeImage: nlxio/ca-cfssl-unsafe
          configAPIImage: nlxio/config-api
          insightAPIImage: nlxio/insight-api
          inwayImage: nlxio/inway
          managementAPIImage: nlxio/management-api
          managementUIImage: nlxio/management-ui
          nlxctlImage: nlxio/nlxctl
          txlogDBImage: nlxio/txlog-db
        namespace: nlx-acc-rdw
      - name: nlx-acc-haarlem
        chartPath: helm/nlx-organization
        valuesFiles:
        - helm/nlx-organization/values-acc-haarlem.yaml
        values:
          authServiceImage: nlxio/auth-service
          caCfsslUnsafeImage: nlxio/ca-cfssl-unsafe
          configAPIImage: nlxio/config-api
          insightAPIImage: nlxio/insight-api
          inwayImage: nlxio/inway
          managementAPIImage: nlxio/management-api
          managementUIImage: nlxio/management-ui
          nlxctlImage: nlxio/nlxctl
          outwayImage: nlxio/outway
          txlogDBImage: nlxio/txlog-db
        namespace: nlx-acc-haarlem
- name: demo
  build:
    tagPolicy:
      gitCommit: {}
    local:
      push: true
  deploy:
    helm:
      releases:
      - name: nlx-demo-directory
        chartPath: helm/nlx-directory
        valuesFiles:
        - helm/nlx-directory/values-demo.yaml
        values:
          caCertportalImage: nlxio/ca-certportal
          caCfsslUnsafeImage: nlxio/ca-cfssl-unsafe
          directoryDBImage: nlxio/directory-db
          directoryInspectionImage: nlxio/directory-inspection-api
          directoryMonitorImage: nlxio/directory-monitor
          directoryRegistrationImage: nlxio/directory-registration-api
          directoryUIImage: nlxio/directory-ui
          docsImage: nlxio/docs
          insightUIImage: nlxio/insight-ui
        namespace: nlx-demo-directory
      - name: nlx-demo-brp
        chartPath: helm/nlx-organization
        valuesFiles:
        - helm/nlx-organization/values-demo-brp.yaml
        values:
          authServiceImage: nlxio/auth-service
          caCfsslUnsafeImage: nlxio/ca-cfssl-unsafe
          configAPIImage: nlxio/config-api
          insightAPIImage: nlxio/insight-api
          inwayImage: nlxio/inway
          managementAPIImage: nlxio/management-api
          managementUIImage: nlxio/management-ui
          nlxctlImage: nlxio/nlxctl
          txlogDBImage: nlxio/txlog-db
        namespace: nlx-demo-brp
      - name: nlx-demo-rdw
        chartPath: helm/nlx-organization
        valuesFiles:
        - helm/nlx-organization/values-demo-rdw.yaml
        setValueTemplates:
         management.basicAuth: "{{.MANAGEMENT_BASIC_AUTH}}"
        values:
          authServiceImage: nlxio/auth-service
          caCfsslUnsafeImage: nlxio/ca-cfssl-unsafe
          configAPIImage: nlxio/config-api
          insightAPIImage: nlxio/insight-api
          inwayImage: nlxio/inway
          managementAPIImage: nlxio/management-api
          managementUIImage: nlxio/management-ui
          nlxctlImage: nlxio/nlxctl
          txlogDBImage: nlxio/txlog-db
        namespace: nlx-demo-rdw
      - name: nlx-demo-haarlem
        chartPath: helm/nlx-organization
        valuesFiles:
        - helm/nlx-organization/values-demo-haarlem.yaml
        values:
          authServiceImage: nlxio/auth-service
          caCfsslUnsafeImage: nlxio/ca-cfssl-unsafe
          configAPIImage: nlxio/config-api
          insightAPIImage: nlxio/insight-api
          inwayImage: nlxio/inway
          outwayImage: nlxio/outway
          managementAPIImage: nlxio/management-api
          managementUIImage: nlxio/management-ui
          nlxctlImage: nlxio/nlxctl
          txlogDBImage: nlxio/txlog-db
        namespace: nlx-demo-haarlem
- name: preprod
  build:
    tagPolicy:
      gitCommit: {}
    local:
      push: false
  deploy:
    helm:
      releases:
      - name: nlx-preprod-directory
        chartPath: helm/nlx-directory
        valuesFiles:
        - helm/nlx-directory/values-preprod.yaml
        values:
          directoryDBImage: nlxio/directory-db
          directoryInspectionImage: nlxio/directory-inspection-api
          directoryMonitorImage: nlxio/directory-monitor
          directoryRegistrationImage: nlxio/directory-registration-api
          directoryUIImage: nlxio/directory-ui
          docsImage: nlxio/docs
          insightUIImage: nlxio/insight-ui
        namespace: nlx-preprod-directory
- name: prod
  build:
    tagPolicy:
      gitCommit: {}
    local:
      push: false
  deploy:
    helm:
      releases:
      - name: nlx-prod-directory
        chartPath: helm/nlx-directory
        valuesFiles:
        - helm/nlx-directory/values-prod.yaml
        values:
          directoryDBImage: nlxio/directory-db
          directoryInspectionImage: nlxio/directory-inspection-api
          directoryMonitorImage: nlxio/directory-monitor
          directoryRegistrationImage: nlxio/directory-registration-api
          directoryUIImage: nlxio/directory-ui
          docsImage: nlxio/docs
          insightUIImage: nlxio/insight-ui
        namespace: nlx-prod-directory
